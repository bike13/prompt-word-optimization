<!DOCTYPE html>
<html lang="zh-Hans">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>ğŸš€ æç¤ºè¯ä¼˜åŒ–å™¨</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/github-markdown-css/github-markdown-light.css"
    />
    <style>
      /* å…¨å±€é‡ç½®å’ŒåŸºç¡€æ ·å¼ */
      * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
      }

      [v-cloak] {
        display: none !important;
      }

      html {
        padding: 0;
        margin: 0;
      }

      body {
        font-family: 'Arial', sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f5f5f5;
      }

      h1,
      h2,
      h3,
      label {
        user-select: none;
      }

      a {
        color: #667eea;
        text-decoration: none;
      }

      a + a {
        margin-left: 12px;
      }

      .ellipsis2 {
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        line-clamp: 2;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
      }

      /* å¸ƒå±€å®¹å™¨å’Œç»“æ„ */
      .container {
        max-width: 1440px;
        margin: 0 auto;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .main-content {
        display: flex;
        min-height: calc(100vh - 40px - 120px);
      }

      .left-panel {
        flex: 1;
        position: relative;
        max-width: 33.33%;
        padding: 20px;
        border-right: 1px solid #e0e0e0;
        background-color: #fafafa;
      }

      .right-panel {
        flex: 2;
        max-width: 66.67%;
        position: relative;
        display: flex;
        flex-direction: column;
      }

      /* å¤´éƒ¨åŒºåŸŸ */
      .header {
        position: relative;
        height: 120px;
        padding: 20px 12px 0;
        text-align: center;
        color: white;
        background: linear-gradient(160deg, #0a0a2e, #16213e, #3b108b, #b83dba);
      }

      .header h1 {
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 2px 0 0;
        padding: 0;
        font-size: 2rem;
        z-index: 1;
      }

      .header h1 small {
        display: inline-block;
        margin-top: -0.3em;
        margin-left: 0.7em;
        font-size: 0.7em;
        animation: breath 3s infinite;
        cursor: pointer;
        user-select: none;
      }

      .header p {
        position: relative;
        margin: 12px 0 0;
        font-size: 0.92em;
        user-select: none;
        z-index: 1;
      }

      /* æ˜Ÿæ˜ŸèƒŒæ™¯è£…é¥° */
      .stars {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        pointer-events: none;
      }

      .star {
        position: absolute;
        background: white;
        border-radius: 50%;
        animation: twinkle 2s infinite;
      }

      .star:nth-child(1) {
        width: 2px;
        height: 2px;
        top: 20%;
        left: 10%;
        animation-delay: 0s;
      }

      .star:nth-child(2) {
        width: 1px;
        height: 1px;
        top: 30%;
        left: 80%;
        animation-delay: 0.5s;
      }

      .star:nth-child(3) {
        width: 2px;
        height: 2px;
        top: 60%;
        left: 20%;
        animation-delay: 1s;
      }

      .star:nth-child(4) {
        width: 2px;
        height: 2px;
        top: 88%;
        left: 70%;
        animation-delay: 1.5s;
      }

      .star:nth-child(5) {
        width: 2px;
        height: 2px;
        top: 12%;
        left: 60%;
        animation-delay: 0.8s;
      }

      /* æµæ˜Ÿæ•ˆæœ */
      .meteor {
        position: absolute;
        z-index: 0;
        width: 4px;
        height: 4px;
        background: #fff;
        border-radius: 50%;
        box-shadow: 0 0 10px #fff, 0 0 20px #fff;
        animation: meteor-move 2s linear infinite;
        opacity: 0;
      }

      .meteor::before {
        content: '';
        position: absolute;
        width: 60px;
        height: 2px;
        top: 0;
        bottom: 0;
        left: 2px;
        margin: auto 0;
        background: linear-gradient(
          90deg,
          rgba(255, 255, 255, 0.9),
          rgba(255, 255, 255, 0.6),
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transform: translate(-100% -100%);
        border-radius: 1px;
      }

      /* ç¬¬ä¸€é¢—æµæ˜Ÿ - å³ */
      .meteor:nth-child(1) {
        top: -1%;
        right: 5%;
        animation-delay: 4s;
        animation-duration: 8.2s;
      }

      .meteor:nth-child(1)::before {
        width: 70px;
        background: linear-gradient(
          90deg,
          rgba(255, 255, 255, 0.9),
          rgba(255, 255, 255, 0.5),
          rgba(255, 255, 255, 0.1),
          transparent
        );
      }

      /* ç¬¬äºŒé¢—æµæ˜Ÿ - ä¸­ */
      .meteor:nth-child(2) {
        top: -1%;
        right: 40%;
        animation-delay: 7s;
        animation-duration: 11.9s;
      }

      .meteor:nth-child(2)::before {
        width: 80px;
        background: linear-gradient(
          90deg,
          rgba(255, 255, 255, 0.8),
          rgba(255, 255, 255, 0.4),
          rgba(255, 255, 255, 0.1),
          transparent
        );
      }

      /* ç¬¬ä¸‰é¢—æµæ˜Ÿ - å·¦ */
      .meteor:nth-child(3) {
        top: -1%;
        right: 82%;
        animation-delay: 3s;
        animation-duration: 9.4s;
      }

      .meteor:nth-child(3)::before {
        width: 65px;
        background: linear-gradient(
          90deg,
          rgba(255, 255, 255, 0.85),
          rgba(255, 255, 255, 0.45),
          rgba(255, 255, 255, 0.15),
          transparent
        );
      }

      /* ç»“æœåŒºåŸŸå’Œä¼˜åŒ–åŒºåŸŸ */
      .result-area {
        flex: 1;
        display: flex;
        flex-direction: column;
        position: relative;
        padding: 20px;
        border-bottom: 4px solid #e0e0e0;
        background-color: #fff;
      }

      .optimization-area {
        flex: 1;
        display: flex;
        flex-direction: column;
        position: relative;
        padding: 20px;
        background-color: #fff;
      }

      .section-header {
        flex: 0 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 5px;
        padding-bottom: 10px;
        user-select: none;
      }

      .section-title {
        margin: 0;
        color: #333;
        font-size: 1.1em;
      }

      .result-content {
        flex: 1 1 0;
        position: relative;
        min-height: 173px;
        padding-top: 20px;
        line-height: 1.6;
        border-top: 2px solid #e0e0e0;
        color: #333;
        overflow-x: hidden;
        overflow-y: auto;
        transition: all 0.2s;
      }

      .result-content div * {
        user-select: text;
      }

      .result-content h1,
      .result-content h2,
      .result-content h3 {
        color: #667eea;
        margin-top: 0;
      }

      .result-content pre {
        position: relative;
        max-width: 100%;
        border-radius: 6px;
        padding: 15px;
        background: #f4f4f4;
      }

      .result-content code {
        display: inline-block !important;
        max-width: 100%;
        padding: 2px 4px;
        white-space: pre-wrap !important;
        word-break: break-all !important;
        border-radius: 3px;
        background: #f4f4f4;
        font-family: 'Courier New', monospace;
      }

      .markdown-body {
        background: none;
        white-space-collapse: collapse;
      }

      /* æ–‡æœ¬è¾“å…¥åŒºåŸŸ */
      .textarea-container {
        position: relative;
        margin-bottom: 20px;
      }

      .textarea-container label {
        display: block;
        margin: 0 0 10px;
        color: #333;
        font-size: 1.1em;
        font-family: Arial, sans-serif;
      }

      .textarea-container textarea {
        width: 100%;
        min-height: 250px;
        max-height: 35em;
        padding: 12px;
        border: 2px solid #ddd;
        border-radius: 6px;
        background: #fff;
        font-family: 'Courier New', monospace;
        font-size: 16px;
        resize: vertical;
        transition: border-color 0.3s;
      }

      .textarea-container textarea:focus {
        outline: none;
        border-color: #667eea;
      }

      .textarea-container textarea.completing {
        animation: blink 1s infinite;
      }

      /* å›¾æ ‡åŒºåŸŸ */
      .icons {
        position: absolute;
        display: flex;
        justify-content: flex-end;
        align-items: center;
        gap: 0.6em;
        flex-wrap: nowrap;
        top: 0px;
        right: 2px;
        width: 6.5em;
        height: 1.5em;
      }

      .icons > * {
        width: 1.5em;
        height: 1.5em;
        line-height: 1.5em;
        text-align: center;
        font-size: 1.1em;
        border-radius: 4px;
        user-select: none;
        cursor: pointer;
      }

      .icons > *:hover {
        background: rgba(102, 126, 234, 0.3);
      }

      /* å¤é€‰æ¡†ç»„ */
      .checkbox-group {
        margin-bottom: 20px;
      }

      .checkbox-group h3 {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
        color: #333;
        font-size: 1.1rem;
      }

      .checkbox-container {
        position: relative;
        display: flex;
        align-items: flex-start;
        flex-wrap: wrap;
        padding: 10px;
        overflow-x: hidden;
        overflow-y: auto;
        border: 1px solid #e0e0e0;
        border-radius: 4px;
        background: white;
      }

      .checkbox-item {
        display: flex;
        align-items: center;
        width: 50%;
        margin: 2px 0;
        padding: 4px;
        white-space: nowrap;
      }

      .checkbox-item input[type='checkbox'] {
        margin-right: 8px;
      }

      .checkbox-item label {
        font-size: 13px;
        cursor: pointer;
        user-select: none;
      }

      /* è‡ªå®šä¹‰ç»´åº¦æ ·å¼ */
      .custom-dimension-item {
        width: 100% !important;
        align-items: center;
        margin-top: 8px;
        padding-top: 12px;
        border-top: 1px dashed #ddd;
      }

      .custom-dimension-input {
        flex: 1;
        margin-left: 8px;
        padding: 4px 8px;
        border: 1px solid #ddd;
        border-radius: 3px;
        font-size: 13px;
        outline: none;
        transition: border-color 0.3s;
      }

      .custom-dimension-input:focus {
        border-color: #667eea;
      }

      .custom-dimension-input::placeholder {
        color: #999;
        font-style: italic;
      }

      /* æŒ‰é’®ç»„ */
      .button-group {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
      }

      .btn {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 12px 18px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        transition: all 0.3s;
        text-transform: uppercase;
        user-select: none;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
      }

      .btn-secondary {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
      }

      .btn-secondary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(245, 87, 108, 0.4);
      }

      .btn-default {
        background: #fff;
        border: 2px dashed #28a745;
        color: #28a745;
      }

      .btn-default:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
      }

      .clear-btn {
        padding: 6px 10px;
        background: rgb(227, 103, 89);
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        transition: background 0.3s;
      }

      .clear-btn:hover {
        background: rgb(207, 83, 69);
      }

      .copy-btn {
        padding: 6px 10px;
        margin-left: 8px;
        background: #28a745;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        transition: background 0.3s;
      }

      .copy-btn:hover {
        background: #218838;
      }

      /* çŠ¶æ€å’Œäº¤äº’æ ·å¼ */
      .btn.disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none !important;
      }

      .icon-complete.busy {
        background: none !important;
        animation: twist 1.75s ease-out infinite;
      }

      .rocket {
        display: inline-block;
        margin-right: 0.35em;
        animation: rocket-tremble 2.15s ease-in-out infinite;
        transform-origin: center;
        cursor: pointer;
      }

      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid #ffffff;
        border-radius: 50%;
        border-top-color: transparent;
        animation: spin 1s ease-in-out infinite;
        margin-right: 8px;
      }

      .empty-state {
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        padding: 50px 20px;
        text-align: center;
        color: #666;
        font-style: italic;
        white-space: pre-wrap;
        user-select: none !important;
        border-radius: 6px;
        overflow: hidden;
      }

      .empty-state.generating {
        background: #e9e9e9;
      }

      .empty-state span {
        position: relative;
        z-index: 1;
        user-select: none !important;
      }

      .generating::before {
        content: '';
        position: absolute;
        top: 0;
        left: -20px;
        width: calc(100% + 40px);
        height: 100%;
        background: linear-gradient(
          45deg,
          transparent 25%,
          rgba(255, 255, 255, 0.3) 25%,
          rgba(255, 255, 255, 0.3) 50%,
          transparent 50%,
          transparent 75%,
          rgba(255, 255, 255, 0.3) 75%
        );
        background-size: 20px 20px;
        animation: slide 1s linear infinite;
      }

      /* åŠ¨ç”»å’Œå…³é”®å¸§ */
      @keyframes twist {
        0%,
        50%,
        100% {
          transform: scaleX(1);
        }

        25%,
        75% {
          transform: scaleX(-1);
        }
      }

      @keyframes blink {
        0%,
        100% {
          background: #fff;
        }

        50% {
          background: rgba(102, 126, 234, 0.2);
        }
      }

      @keyframes meteor-move {
        0%,
        100% {
          transform: translateX(0) translateY(0) rotate(-45deg);
          opacity: 0;
        }

        1% {
          opacity: 1;
        }

        25% {
          transform: translateX(-3000%) translateY(3000%) rotate(-45deg);
          opacity: 1;
        }

        30% {
          transform: translateX(-3600%) translateY(3600%) rotate(-45deg);
          opacity: 0;
        }

        35% {
          transform: translateX(0) translateY(0) rotate(-45deg);
          opacity: 0;
        }
      }

      @keyframes breath {
        0%,
        100% {
          transform-origin: 0 100%;
          transform: scale(1) rotate(0);
        }

        50% {
          transform: scale(1.15) rotate(9deg);
        }
      }

      @keyframes rocket-tremble {
        0% {
          transform: translateY(0px) translateX(0px) rotate(0deg);
        }

        15% {
          transform: translateY(-1px) translateX(0.5px) rotate(0.3deg);
        }

        30% {
          transform: translateY(0.5px) translateX(-0.3px) rotate(-0.2deg);
        }

        45% {
          transform: translateY(-0.8px) translateX(0.7px) rotate(0.4deg);
        }

        60% {
          transform: translateY(1px) translateX(-0.5px) rotate(-0.3deg);
        }

        75% {
          transform: translateY(-0.5px) translateX(0.3px) rotate(0.2deg);
        }

        90% {
          transform: translateY(0.3px) translateX(-0.2px) rotate(-0.1deg);
        }

        100% {
          transform: translateY(0px) translateX(0px) rotate(0deg);
        }
      }

      @keyframes twinkle {
        0%,
        100% {
          opacity: 0.3;
        }

        50% {
          opacity: 1;
        }
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      @keyframes slide {
        0% {
          transform: translateX(-20px);
        }

        100% {
          transform: translateX(0);
        }
      }

      /* å“åº”å¼åª’ä½“æŸ¥è¯¢ */
      @media (max-width: 768px) {
        body {
          padding: 0;
        }

        .container {
          margin: 0;
          border-radius: 0;
          padding-bottom: 10px;
        }

        .main-content {
          flex-direction: column;
          min-height: auto;
        }

        .left-panel {
          max-width: 100%;
          border-right: none;
          border-bottom: 4px solid #e0e0e0;
        }

        .right-panel {
          max-width: 100%;
          flex-direction: column;
        }

        .icon-clear,
        .icon-complete {
          background: none !important;
        }

        .textarea-container textarea {
          min-height: 150px;
          max-height: 80vh;
        }

        .checkbox-container {
          max-height: 164px;
        }

        .button-group {
          flex-direction: column;
        }

        .btn {
          width: 100%;
        }

        .empty-state {
          height: auto;
        }

        .result-content.full {
          min-height: calc(100vh - 40px - 38px - 5px);
          max-height: calc(100vh - 40px - 38px - 5px);
        }

        .result-content.fold {
          max-height: 0 !important;
          min-height: 0 !important;
          padding-top: 0;
          border-top: none;
          overflow: hidden;
        }

        .area:has(.fold) .section-header {
          padding-bottom: 0;
          margin-bottom: 0;
        }
      }
    </style>
  </head>

  <body>
    <div id="app">
      <div class="container">
        <div class="header">
          <h1>
            <span class="rocket" @click="showHelp()">ğŸš€</span>
            <span>æç¤ºè¯ä¼˜åŒ–å™¨</span>
            <small class="icon-history" @click="showHistory()">ğŸ’­</small>
          </h1>
          <p>æ™ºèƒ½è¯„ä¼°å’Œä¼˜åŒ–æ‚¨çš„AIæç¤ºè¯ï¼Œé—®å¾—æ›´å¥½ï¼Œé—®å‡ºæ°´å¹³</p>
          <div class="stars">
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div>
              <div class="meteor"></div>
              <div class="meteor"></div>
              <div class="meteor"></div>
            </div>
          </div>
        </div>

        <div class="main-content">
          <!-- åŒºåŸŸ1: è¾“å…¥å’Œæ§åˆ¶åŒºåŸŸ -->
          <div class="left-panel">
            <div class="textarea-container">
              <label for="prompt-input"
                ><strong>âœï¸ è¯·è¾“å…¥æ‚¨çš„åŸå§‹æç¤ºè¯ï¼š</strong></label
              >
              <textarea
                id="prompt-input"
                v-model="promptText"
                :class="{completing: isCompleting}"
                maxlength="5000"
                :readonly="isCompleting"
                placeholder="åœ¨è¿™é‡Œè¾“å…¥æ‚¨æƒ³è¦ä¼˜åŒ–çš„æç¤ºè¯ï¼ˆ5~5000å­—ï¼‰"
                @change="saveCache()"
                @input="saveCache()"
              ></textarea>
              <span class="icons" v-cloak>
                <span
                  v-if="canUndoPrompt"
                  class="icon-undo"
                  title="æ’¤é”€æ¶¦è‰²"
                  @click="undoPrompt"
                  >â†©ï¸</span
                >
                <span
                  v-if="prompt.length >= 5 && prompt.length <= 120"
                  class="icon-complete"
                  :class="{busy: isCompleting}"
                  title="æ¶¦è‰²"
                  @click="quickComplete()"
                  >âœ¨</span
                >
                <span
                  v-if="prompt.length"
                  class="icon-clear"
                  title="æ¸…ç©º"
                  @click="clearPrompt()"
                  >âŒ</span
                >
              </span>
            </div>

            <div class="checkbox-group">
              <h3>
                <span>ğŸ“‹ è¯„ä¼°ç»´åº¦é€‰æ‹©</span>
                <small>
                  <a href="javascript:void(0)" @click="selectAllDimensions()"
                    >å…¨é€‰</a
                  >
                  <span>&nbsp;/&nbsp;</span>
                  <a href="javascript:void(0)" @click="deselectAllDimensions()"
                    >å…¨ä¸é€‰</a
                  >
                </small>
              </h3>
              <div class="checkbox-container" v-cloak>
                <div
                  class="checkbox-item"
                  v-for="dimension in allDimensions"
                  :key="dimension.value"
                  :title="dimension.value"
                >
                  <input
                    type="checkbox"
                    :id="dimension.value"
                    :value="dimension.value"
                    v-model="selectedDimensions"
                    @change="saveCache()"
                  />
                  <label :for="dimension.value">{{ dimension.label }}</label>
                </div>
                <!-- è‡ªå®šä¹‰ç»´åº¦è¾“å…¥æ¡† -->
                <div class="checkbox-item custom-dimension-item">
                  <input
                    type="checkbox"
                    id="custom-dimension-checkbox"
                    :checked="customDimension.trim().length > 0"
                    @change="toggleCustomDimension"
                  />
                  <input
                    type="text"
                    id="custom-dimension-input"
                    v-model="customDimension"
                    maxlength="50"
                    placeholder="è¾“å…¥è‡ªå®šä¹‰è¯„ä¼°ç»´åº¦ (Better in English)"
                    @input="saveCache()"
                    @change="saveCache()"
                    class="custom-dimension-input"
                  />
                </div>
              </div>
            </div>

            <div class="button-group" v-cloak>
              <button
                class="btn btn-primary"
                :class="{disabled: isEvaluating || isOptimizing || !prompt || !selectedDimensions.length && !customDimension.trim()}"
                @click="executeEvaluation()"
              >
                <span v-if="isEvaluating" class="loading"></span>
                {{ isEvaluating ? 'è¯„ä¼°ä¸­...' : 'ğŸ” æ‰§è¡Œè¯„ä¼°' }}
              </button>

              <button
                class="btn btn-secondary"
                :class="{disabled: isEvaluating || isOptimizing || !prompt || !evaluationResult}"
                @click="executeOptimization()"
              >
                <span v-if="isOptimizing" class="loading"></span>
                {{ isOptimizing ? 'ä¼˜åŒ–ä¸­...' : 'âš¡ æ‰§è¡Œä¼˜åŒ–' }}
              </button>

              <button
                v-if="!isEvaluating && !isOptimizing && (optimizationResult || prompt.length > 120)"
                class="btn btn-default"
                @click="goToAskAi()"
              >
                <span>ğŸ‘‹ å»é—®AIå§</span>
              </button>
            </div>
          </div>

          <div class="right-panel">
            <!-- åŒºåŸŸ2: è¯„ä¼°ç»“æœå±•ç¤º -->
            <div class="area result-area">
              <div class="section-header">
                <h2 class="section-title">
                  <span>ğŸ“Š è¯„ä¼°æŠ¥å‘Š</span>
                  <small v-if="canFoldEvaluation" v-cloak>
                    &nbsp;
                    <a
                      href="javascript:void(0)"
                      @click="toggleFold('Evaluation')"
                      >{{ isFoldEvaluation ? 'å±•å¼€' : 'æ”¶èµ·' }}</a
                    >
                  </small>
                </h2>
                <span>
                  <button
                    v-if="evaluationResult"
                    class="clear-btn"
                    v-cloak
                    @click="clearResult('evaluationResult')"
                  >
                    âŒ æ¸…ç©º
                  </button>
                  <button
                    v-if="evaluationResult"
                    class="copy-btn"
                    v-cloak
                    @click="copyToClipboard('evaluationResult')"
                  >
                    ğŸ“‹ å¤åˆ¶ï¼šè¯„ä¼°æŠ¥å‘Š
                  </button>
                </span>
              </div>
              <div
                class="result-content"
                :class="{full: evaluationResult, fold: isMobile && evaluationResult && isFoldEvaluation}"
              >
                <div
                  v-if="evaluationResult"
                  class="markdown-body"
                  v-html="evaluationResultHtml"
                ></div>
                <div
                  v-else
                  class="empty-state"
                  :class="{generating: isEvaluating}"
                  v-cloak
                >
                  <span
                    >{{ !isEvaluating ? '' : 'æ­£åœ¨è¯„ä¼°... '
                    }}è¯„ä¼°æŠ¥å‘Šå°†åœ¨è¿™é‡Œæ˜¾ç¤º...{{ !isEvaluating ? '' :
                    '\nç”¨æ—¶çº¦25~40ç§’ï¼Œè¯·è€å¿ƒç­‰å€™...' }}
                  </span>
                </div>
              </div>
            </div>

            <!-- åŒºåŸŸ3: ä¼˜åŒ–ç»“æœå±•ç¤º -->
            <div class="area optimization-area">
              <div class="section-header">
                <h2 class="section-title">
                  <span>âœ¨ ä¼˜åŒ–ç»“æœ</span>
                  <small v-if="canFoldOptimization" v-cloak>
                    &nbsp;
                    <a
                      href="javascript:void(0)"
                      @click="toggleFold('Optimization')"
                      >{{ isFoldOptimization ? 'å±•å¼€' : 'æ”¶èµ·' }}</a
                    >
                  </small>
                </h2>
                <span>
                  <button
                    v-if="optimizationResult"
                    class="clear-btn"
                    v-cloak
                    @click="clearResult('optimizationResult')"
                  >
                    âŒ æ¸…ç©º
                  </button>
                  <button
                    v-if="optimizationResult"
                    class="copy-btn"
                    v-cloak
                    @click="copyToClipboard('optimizationResult')"
                  >
                    ğŸ“‹ å¤åˆ¶æœ€ç»ˆæç¤ºè¯
                  </button>
                </span>
              </div>
              <div
                class="result-content"
                :class="{full: optimizationResult, fold: isMobile && optimizationResult && isFoldOptimization}"
              >
                <div
                  v-if="optimizationResult"
                  class="markdown-body"
                  v-html="optimizationResultHtml"
                ></div>
                <div
                  v-else
                  class="empty-state"
                  :class="{generating: isOptimizing}"
                  v-cloak
                >
                  <span
                    >{{ !isOptimizing ? '' : 'æ­£åœ¨ä¼˜åŒ–... '
                    }}ä¼˜åŒ–ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º...{{ !isOptimizing ? '' :
                    '\nç”¨æ—¶çº¦35ç§’ï¼Œè¯·è€å¿ƒç­‰å€™...' }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- å¼•å…¥JSåº“ -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/sweetalert2@11"></script>
    <script src="https://unpkg.com/showdown/dist/showdown.min.js"></script>

    <script>
      const { createApp } = Vue;

      window.app = createApp({
        data() {
          return {
            promptText: '',
            selectedDimensions: [],
            evaluationResult: '',
            optimizationResult: '',
            isCompleting: false,
            isEvaluating: false,
            isOptimizing: false,
            allDimensions: [
              {
                value: 'Clarity & Specificity',
                label: 'æ¸…æ™°åº¦ä¸å…·ä½“æ€§'
              },
              {
                value: 'Context / Background Provided',
                label: 'ä¸Šä¸‹æ–‡/èƒŒæ™¯ä¿¡æ¯æä¾›'
              },
              {
                value: 'Explicit Task Definition',
                label: 'æ˜ç¡®çš„ä»»åŠ¡å®šä¹‰'
              },
              {
                value: 'Feasibility within Model Constraints',
                label: 'æ¨¡å‹èƒ½åŠ›èŒƒå›´å†…çš„å¯è¡Œæ€§'
              },
              {
                value: 'Avoiding Ambiguity or Contradictions',
                label: 'é¿å…æ¨¡ç³Šæ€§æˆ–å†…åœ¨çŸ›ç›¾'
              },
              {
                value: 'Model Fit / Scenario Appropriateness',
                label: 'æ¨¡å‹é€‚é…æ€§/åœºæ™¯é€‚ç”¨æ€§'
              },
              {
                value: 'Desired Output Format / Style',
                label: 'æœŸæœ›çš„è¾“å‡ºæ ¼å¼/é£æ ¼'
              },
              {
                value: 'Use of Role or Persona',
                label: 'è§’è‰²è®¾å®š'
              },
              {
                value: 'Step-by-Step Reasoning Encouraged',
                label: 'é¼“åŠ±è¿›è¡Œåˆ†æ­¥æ¨ç†'
              },
              {
                value: 'Structured / Numbered Instructions',
                label: 'ç»“æ„åŒ–/ç¼–å·æŒ‡ä»¤'
              },
              {
                value: 'Brevity vs. Detail Balance',
                label: 'ç®€æ´ä¸è¯¦ç»†çš„å¹³è¡¡'
              },
              {
                value: 'Iteration / Refinement Potential',
                label: 'è¿­ä»£/ä¼˜åŒ–æ½œåŠ›'
              },
              {
                value: 'Examples or Demonstrations',
                label: 'æä¾›ç¤ºä¾‹æˆ–æ¼”ç¤º'
              },
              {
                value: 'Handling Uncertainty / Gaps',
                label: 'å¤„ç†ä¸ç¡®å®šæ€§/ä¿¡æ¯ç©ºç™½'
              },
              {
                value: 'Hallucination Minimization',
                label: 'æœ€å°åŒ–"å¹»è§‰"ç°è±¡'
              },
              {
                value: 'Knowledge Boundary Awareness',
                label: 'çŸ¥è¯†è¾¹ç•Œæ„è¯†'
              },
              {
                value: 'Audience Specification',
                label: 'æ˜ç¡®ç›®æ ‡å—ä¼—'
              },
              {
                value: 'Style Emulation or Imitation',
                label: 'é£æ ¼æ¨¡æ‹Ÿæˆ–æ¨¡ä»¿'
              },
              {
                value: 'Memory Anchoring (Multi-Turn Systems)',
                label: 'è®°å¿†é”šå®š(ç”¨äºå¤šè½®å¯¹è¯)'
              },
              {
                value: 'Meta-Cognition Triggers',
                label: 'å…ƒè®¤çŸ¥è§¦å‘(å¼•å¯¼æ¨¡å‹åæ€)'
              },
              {
                value: 'Divergent vs. Convergent Thinking Management',
                label: 'å‘æ•£æ€§/æ”¶æ•›æ€§æ€ç»´ç®¡ç†'
              },
              {
                value: 'Hypothetical Frame Switching',
                label: 'å‡è®¾æ€§æ¡†æ¶åˆ‡æ¢'
              },
              {
                value: 'Safe Failure Mode',
                label: 'å®‰å…¨çš„å¤±è´¥æ¨¡å¼è®¾è®¡'
              },
              {
                value: 'Progressive Complexity',
                label: 'æ¸è¿›å¼å¢åŠ å¤æ‚æ€§'
              },
              {
                value: 'Alignment with Evaluation Metrics',
                label: 'ä¸è¯„ä¼°æŒ‡æ ‡å¯¹é½'
              },
              {
                value: 'Calibration Requests',
                label: '(å¯¹è¾“å‡ºçš„)æ ¡å‡†è¯·æ±‚'
              },
              {
                value: 'Output Validation Hooks',
                label: 'è¾“å‡ºéªŒè¯æŒ‚é’©/æœºåˆ¶'
              },
              {
                value: 'Time/Effort Estimation Request',
                label: 'æ—¶é—´/ç²¾åŠ›æ¶ˆè€—é¢„ä¼°è¯·æ±‚'
              },
              {
                value: 'Ethical Alignment or Bias Mitigation',
                label: 'ä¼¦ç†å¯¹é½æˆ–åè§ç¼“è§£'
              },
              {
                value: 'Limitations Disclosure',
                label: 'å±€é™æ€§æŠ«éœ²'
              },
              {
                value: 'Compression / Summarization Ability',
                label: 'å‹ç¼©/æ‘˜è¦èƒ½åŠ›'
              },
              {
                value: 'Cross-Disciplinary Bridging',
                label: 'è·¨å­¦ç§‘çŸ¥è¯†æ¡¥æ¥'
              },
              {
                value: 'Emotional Resonance Calibration',
                label: 'æƒ…æ„Ÿå…±é¸£æ ¡å‡†'
              },
              {
                value: 'Output Risk Categorization',
                label: 'è¾“å‡ºå†…å®¹çš„é£é™©åˆ†ç±»'
              },
              {
                value: 'Self-Repair Loops',
                label: 'è‡ªæˆ‘ä¿®å¤å¾ªç¯'
              }
            ],
            userAgent: window.navigator.userAgent,
            isFoldEvaluation: false,
            isFoldOptimization: false,
            __previousPrompt: '',
            __lastCompletePrompt: '',
            customDimension: ''
          };
        },
        computed: {
          prompt() {
            return (this.promptText || '').trim();
          },
          evaluationResultHtml() {
            if (!this.evaluationResult) return '';
            const converter = new showdown.Converter();
            converter.setOption('simpleLineBreaks', true);
            converter.setOption('simplifiedAutoLink', false);
            converter.setOption('excludeTrailingPunctuationFromURLs', true);
            converter.setOption('literalMidWordUnderscores', true);
            converter.setOption('strikethrough', true);
            converter.setOption('tasklists', true);
            converter.setOption('tables', true);
            const str = this.evaluationResult
              .replace(/\\\\n/g, '\n')
              .replace(/\\n/g, '\n');
            return converter.makeHtml(str);
          },
          optimizationResultHtml() {
            if (!this.optimizationResult) return '';
            const converter = new showdown.Converter();
            converter.setOption('simpleLineBreaks', true);
            converter.setOption('simplifiedAutoLink', false);
            converter.setOption('excludeTrailingPunctuationFromURLs', true);
            converter.setOption('literalMidWordUnderscores', true);
            converter.setOption('strikethrough', true);
            converter.setOption('tasklists', true);
            converter.setOption('tables', true);
            const str = this.optimizationResult
              .replace(/\\\\n/g, '\n')
              .replace(/\\n/g, '\n');
            return converter.makeHtml(str);
          },
          isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
              this.userAgent
            );
          },
          canUndoPrompt() {
            return (
              this.__previousPrompt &&
              this.__lastCompletePrompt &&
              this.promptText === this.__lastCompletePrompt
            );
          },
          canFoldEvaluation() {
            if (!this.isMobile) return false;
            if (this.isEvaluating || !this.evaluationResult) return false;
            return true;
          },
          canFoldOptimization() {
            if (!this.isMobile) return false;
            if (this.isOptimizing || !this.optimizationResult) return false;
            return true;
          }
        },
        methods: {
          warn(
            text,
            title = 'æç¤º',
            icon = 'warning',
            confirmButtonText = 'ç¡®å®š'
          ) {
            return Swal.fire({
              title,
              text,
              icon,
              confirmButtonText
            });
          },
          success(text, title = 'æˆåŠŸ', timer = 1500) {
            return Swal.fire({
              icon: 'success',
              title,
              text,
              timer,
              showConfirmButton: false
            });
          },
          info(text, title = null, icon = 'info') {
            return Swal.fire({
              icon,
              title,
              text,
              confirmButtonText: 'ç¡®å®š'
            });
          },
          confirm(
            text,
            title = 'è¯·ç¡®è®¤',
            icon = 'question',
            confirmButtonText = 'ç¡®è®¤',
            cancelButtonText = 'å–æ¶ˆ'
          ) {
            return Swal.fire({
              title,
              text,
              icon,
              confirmButtonText,
              cancelButtonText,
              showCancelButton: true,
              reverseButtons: true
            }).then(res => {
              if (res.isConfirmed) {
                return true;
              } else {
                return false;
              }
            });
          },
          showHelp(isAuto = false) {
            if (isAuto) {
              // æ£€æŸ¥ä»Šæ—¥æ˜¯å¦å·²ç»ç‚¹è¿‡"ä»Šæ—¥ä¸å†å¼¹å‡º"
              const today = new Date().toDateString();
              const noShowToday = localStorage.getItem('hasViewPromptReadme');
              if (noShowToday === today) return;
            }
            Swal.fire({
              title: null,
              icon: this.isMobile ? null : 'info',
              html: `<div class="markdown-body" style="text-align: left"><p><strong>å„ä½ AI ç©å®¶è¯·æ³¨æ„ï¼Œæˆ‘çš„"æç¤ºè¯ä¼˜åŒ–å™¨"æ–°é²œå‡ºç‚‰äº†ï¼</strong></p>
      <p><small>æ•´ä¸ªé¡¹ç›®è·‘åœ¨ä¸€ä¸ª FastAPI åç«¯é‡Œï¼Œå‰ç«¯é€šè¿‡Vue.jsæ„å»ºï¼Œä¸»æ‰“ä¸€ä¸ªè½»é‡é«˜æ•ˆã€‚</small></p>
      <p>å¿«æ¥è¯•è¯•è¿™ä¸¤ç§"ç‚¼ä¸¹"æ¨¡å¼ï¼š</p>
      <ol><li>
      ä¸“å®¶è¯Šæ–­ä¹¦ ğŸ‘¨â€âš•ï¸ï¼š<br>
      æƒ³çŸ¥é“ä½ çš„æç¤ºè¯"ç—…"åœ¨å“ªå—ï¼Ÿæäº¤ä½ çš„æç¤ºè¯ï¼Œå‹¾é€‰å‡ ä¸ªä½ å…³å¿ƒçš„ç»´åº¦ï¼Œã€æ‰§è¡Œè¯„ä¼°ã€‘ï¼ŒAIæ¨¡å‹ä¼šç»™ä½ ä¸€ä»½ä¸“ä¸šçš„"ä½“æ£€æŠ¥å‘Š"ï¼Œå‘Šè¯‰ä½ ä»å“ªä¸‹æ‰‹æ”¹è¿›ã€‚
      </li>
      <li>
      ç©¶æè¶…è¿›åŒ– ğŸš€ï¼š<br>
      å‡†å¤‡å¥½è§è¯å¥‡è¿¹äº†å—ï¼Ÿå°†æç¤ºè¯å’Œä¸Šé¢çš„"ä½“æ£€æŠ¥å‘Š"ä¸€èµ·æäº¤ï¼Œã€æ‰§è¡Œä¼˜åŒ–ã€‘ï¼ŒAIæ¨¡å‹ä¼šä¸ºä½ æ‰“é€ å‡ºä¸€ä¸ª"å®Œå…¨ä½“"çš„è¶…çº§æç¤ºè¯ï¼æ‹¿ç€å®ƒå»"æ‹·é—®" AIï¼Œçœ‹çœ‹å›ç­”è´¨é‡æ˜¯ä¸æ˜¯åŸåœ°èµ·é£ï¼</li></ol>
      <p><small>ï¼ˆç‚¹å‡»é¡µé¢é¡¶éƒ¨çš„ ğŸš€ å’Œ ğŸ’­ å›¾æ ‡åˆ†åˆ«å¯ä»¥æŸ¥çœ‹ <i>å¸®åŠ©ä¿¡æ¯</i> å’Œ <i>å†å²è®°å½•</i>ï¼‰</small></p>
      </div>`,
              width: this.isMobile ? null : '570px',
              padding: this.isMobile ? '6px 0 10px' : null,
              inputAutoFocus: false,
              showCloseButton: false,
              showCancelButton: true,
              showConfirmButton: true,
              focusConfirm: false,
              cancelButtonText: 'ä»Šæ—¥ä¸å†å¼¹å‡º',
              confirmButtonText: 'æˆ‘çŸ¥é“äº†',
              reverseButtons: true
            }).then(result => {
              if (
                result.isDismissed &&
                result.dismiss === Swal.DismissReason.cancel
              ) {
                // ç”¨æˆ·ç‚¹å‡»äº†"ä»Šæ—¥ä¸å†å¼¹å‡º"
                const today = new Date().toDateString();
                localStorage.setItem('hasViewPromptReadme', today);
              }
            });
          },
          showHistory() {
            const historyList = this.loadHistory();
            let historyHtml = `<br><p>è¿™é‡Œè®°å½•äº†æ‚¨ä¼˜åŒ–è¿‡çš„æç¤ºè¯ï¼Œ${
              this.isMobile ? '<br>' : ''
            }è‡³å¤šä¿ç•™æœ€è¿‘çš„30æ¡ã€‚</p><div style="position: relative; max-height: 50vh; overflow: auto;"
                ><table
                  style="position: relative;">
                    <colgroup style="width: 7em"></colgroup>
                    <colgroup style="max-width: 22em"></colgroup>
                    <colgroup style="width: 4em"></colgroup>
                    <thead>
                      <tr>
                        <th>æ—¥æœŸ</th>
                        <th>æç¤ºè¯</th>
                        <th>æ“ä½œ</th>
                      </tr>
                    </thead>
                    <tbody>
                      ${historyList
                        .map(i => {
                          return (
                            '<tr><td style="white-space: nowrap;">' +
                            new Date(i.time).toLocaleDateString() +
                            '</td><td><div class="ellipsis2">' +
                            i.promptText.slice(0, 120) +
                            '</div></td><td><a href="javascript:void(0)" data-restore>è¿˜åŸ</a><br><a href="javascript:void(0)" data-delete style="display: inline-block; margin-top: 0.28em; color: #c00;">åˆ é™¤</a></td>'
                          );
                        })
                        .join('')}
                    </tbody>
                  </table></div><hr>`;
            if (!historyList.length) historyHtml = '<br>';
            const dialog = Swal.fire({
              title: null,
              icon: null,
              width: this.isMobile ? null : '38.5em',
              html: `${historyHtml}<small>created by FastAPI + Vue.js</small><br><small>2025/1/15</small><br><br><small>å…¬ç›Šè¡Œä¸ºï¼Œè¯·åˆç†ä½¿ç”¨ï¼Œæ„Ÿè°¢ï¼</small>`,
              inputAutoFocus: false,
              showCloseButton: false,
              showCancelButton: false,
              focusConfirm: false,
              confirmButtonText: '&emsp;OK&emsp;',
              customClass: {
                htmlContainer: 'history-container markdown-body'
              }
            });
            const bindEvent = () => {
              const list = this.loadHistory();
              const btnsRestore = [
                ...document.querySelectorAll(
                  '.history-container table td a[data-restore]'
                )
              ];
              const btnsDelete = [
                ...document.querySelectorAll(
                  '.history-container table td a[data-delete]'
                )
              ];
              btnsRestore.forEach((btn, index) => {
                btn.onclick = () => {
                  const history = historyList[index];
                  for (const k in history) {
                    this[k] = history[k];
                  }
                  dialog.close();
                  this.saveCache();
                };
              });
              btnsDelete.forEach((btn, index) => {
                btn.onclick = () => {
                  list.splice(index, 1);
                  localStorage.setItem('promptHistory', JSON.stringify(list));
                  btn.closest('tr').remove();
                  bindEvent();
                };
              });
            };
            setTimeout(() => bindEvent(), 0);
          },
          // ç»´åº¦å…¨é€‰
          selectAllDimensions() {
            this.selectedDimensions = this.allDimensions.map(i => i.value);
            this.saveCache();
          },
          // ç»´åº¦å…¨ä¸é€‰
          deselectAllDimensions() {
            this.selectedDimensions = [];
            this.saveCache();
          },
          // åˆ‡æ¢è‡ªå®šä¹‰ç»´åº¦
          toggleCustomDimension(event) {
            if (!event.target.checked) {
              this.customDimension = '';
              this.saveCache();
            }
          },
          async quickComplete() {
            // å¿«é€Ÿè¡¥å…¨åŠŸèƒ½æš‚æ—¶ç¦ç”¨ï¼Œå› ä¸ºåç«¯æ²¡æœ‰å¯¹åº”æ¥å£
            this.warn('å¿«é€Ÿè¡¥å…¨åŠŸèƒ½æš‚æœªå®ç°ï¼Œè¯·ä½¿ç”¨è¯„ä¼°å’Œä¼˜åŒ–åŠŸèƒ½');
          },
          undoPrompt() {
            if (!this.canUndoPrompt) return;
            this.promptText = this.__previousPrompt;
            this.__previousPrompt = '';
            this.__lastCompletePrompt = '';
            this.saveCache();
          },
          async executeEvaluation() {
            if (this.validate('evaluate') !== true) return;
            const prompt = this.prompt;
            if (this.isEvaluating) return;
            this.isEvaluating = true;
            this.evaluationResult = '';
            this.isFoldEvaluation = false;
            // åˆå¹¶å›ºå®šç»´åº¦å’Œè‡ªå®šä¹‰ç»´åº¦
            let allDimensions = [...this.selectedDimensions];
            if (this.customDimension.trim()) {
              allDimensions.push(this.customDimension.trim());
            }
            const params = {
              prompt_content: prompt,
              dimensions: allDimensions
            };
            const data = await this.apiCall('/api/prompt_evaluation', params);
            this.isEvaluating = false;
            if (!data) return;
            this.success('å·²ç”Ÿæˆè¯„ä¼°æŠ¥å‘Šï¼', 'æˆåŠŸ', 2500);
            this.evaluationResult = data.evaluation_result || '';
            this.isFoldEvaluation = false;
            this.saveCache();
          },
          async executeOptimization() {
            if (this.validate('optimize') !== true) return;
            const prompt = this.prompt;
            if (prompt.length < 5) return this.warn('æç¤ºè¯å†…å®¹è¿‡çŸ­ï¼');
            if (prompt.length > 5000) return this.warn('æç¤ºè¯å†…å®¹è¿‡é•¿ï¼');
            if (!this.evaluationResult) return this.warn('è¯·å…ˆæ‰§è¡Œè¯„ä¼°ï¼');
            if (this.isOptimizing) return;
            this.isOptimizing = true;
            this.optimizationResult = '';
            this.isFoldOptimization = false;
            const params = {
              prompt_content: prompt,
              evaluation_result: this.evaluationResult
            };
            const data = await this.apiCall('/api/prompt_refinement', params);
            this.isOptimizing = false;
            if (!data) return;
            this.success('å·²å®Œæˆæç¤ºè¯ä¼˜åŒ–ï¼', 'æˆåŠŸ', 2500);
            this.optimizationResult = data.refinement_result || '';
            this.isFoldOptimization = false;
            this.saveCache();
            this.saveHistory();
          },
          apiCall(url, data) {
            const headers = { 'Content-Type': 'application/json' };
            data = JSON.stringify(data);
            return fetch(url, {
              method: 'POST',
              headers,
              body: data
            })
              .then(res => {
                return res.json();
              })
              .then(json => {
                if (json.detail) {
                  this.warn(
                    json.detail || 'æ¥å£è°ƒç”¨å¤±è´¥ï¼',
                    'é”™è¯¯',
                    'error'
                  );
                  return null;
                }
                return json;
              })
              .catch(e => {
                console.error(e);
                this.warn('æ¥å£è°ƒç”¨å¤±è´¥ï¼', 'é”™è¯¯', 'error');
                return null;
              });
          },
          saveCache() {
            if (this.promptText.length > 5000) {
              this.promptText = this.promptText.slice(0, 5000);
            }
            const promptCache = {
              promptText: this.prompt || '',
              __previousPrompt: this.__previousPrompt || '',
              __lastCompletePrompt: this.__lastCompletePrompt || '',
              selectedDimensions: this.selectedDimensions,
              customDimension: this.customDimension || '',
              evaluationResult: this.evaluationResult || '',
              optimizationResult: this.optimizationResult || ''
            };
            localStorage.setItem('promptCache', JSON.stringify(promptCache));
          },
          loadCache() {
            let cache = localStorage.getItem('promptCache');
            if (!cache) return;
            cache = JSON.parse(cache);
            for (const k in cache) {
              let val = cache[k];
              // æ ¡éªŒä¸€ä¸‹selectedDimensionsæ•°ç»„,å¹¶ä¿è¯æŒ‰å›ºå®šçš„æ¬¡åºæ’åˆ—
              if (k === 'selectedDimensions') {
                val = (val || []).filter(i =>
                  this.allDimensions.some(d => d.value === i)
                );
              }
              this[k] = val;
            }
          },
          saveHistory() {
            const {
              promptText,
              selectedDimensions,
              customDimension,
              evaluationResult,
              optimizationResult
            } = this;
            let historyList = this.loadHistory();
            historyList.unshift({
              time: Date.now(),
              promptText,
              selectedDimensions,
              customDimension,
              evaluationResult,
              optimizationResult
            });
            historyList = historyList.slice(0, 30);
            localStorage.setItem('promptHistory', JSON.stringify(historyList));
          },
          loadHistory() {
            let historyList = [];
            try {
              const str = localStorage.getItem('promptHistory') || '[]';
              historyList = JSON.parse(str);
            } catch (e) {}
            return historyList;
          },
          clearHistory() {
            localStorage.removeItem('promptHistory');
          },
          async clearPrompt() {
            const doClear = () => {
              this.promptText = '';
              this.saveCache();
            };
            if (this.prompt.length <= 10) {
              return doClear();
            }
            const isConfirmed = await this.confirm('ç¡®è®¤è¦æ¸…ç©ºåŸå§‹æç¤ºè¯å—ï¼Ÿ');
            if (isConfirmed) {
              doClear();
            }
          },
          async clearResult(key) {
            const name = key === 'evaluationResult' ? 'è¯„ä¼°æŠ¥å‘Š' : 'ä¼˜åŒ–ç»“æœ';
            const isConfirmed = await this.confirm(`ç¡®è®¤è¦æ¸…ç©º${name}å—ï¼Ÿ`);
            if (isConfirmed) {
              this[key] = '';
              this.saveCache();
            }
          },
          toggleFold(type) {
            const key = `isFold${type}`;
            this[key] = !this[key];
          },
          async copyToClipboard(key) {
            if (key === 'evaluationResult') {
              try {
                await navigator.clipboard.writeText(
                  this.evaluationResult.trim()
                );
                this.success('è¯„ä¼°æŠ¥å‘Šå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼', 'å¤åˆ¶æˆåŠŸ');
              } catch (error) {
                console.error('å¤åˆ¶å¤±è´¥:', error);
                this.warn(
                  'æ— æ³•å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ï¼',
                  'å¤åˆ¶å¤±è´¥',
                  'error'
                );
              }
            }
            if (key === 'optimizationResult') {
              const code = document.querySelector(
                '.optimization-area pre code'
              );
              try {
                await navigator.clipboard.writeText(code.innerText.trim());
                this.success('ä¼˜åŒ–åçš„æç¤ºè¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼', 'å¤åˆ¶æˆåŠŸ');
              } catch (error) {
                console.error('å¤åˆ¶å¤±è´¥:', error);
                this.warn(
                  'æ— æ³•å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ï¼',
                  'å¤åˆ¶å¤±è´¥',
                  'error'
                );
              }
            }
          },
          validate(key) {
            if (key === 'evaluate') {
              if (!this.prompt.length) return this.warn('è¯·è¾“å…¥æç¤ºè¯ï¼');
              if (this.prompt.length < 5) return this.warn('æç¤ºè¯å†…å®¹è¿‡çŸ­ï¼');
              if (this.prompt.length > 5000)
                return this.warn('æç¤ºè¯å†…å®¹è¿‡é•¿ï¼');
              if (
                this.selectedDimensions.length < 1 &&
                !this.customDimension.trim()
              )
                return this.warn('è¯·è‡³å°‘é€‰æ‹©1ä¸ªè¯„ä¼°ç»´åº¦æˆ–è¾“å…¥è‡ªå®šä¹‰ç»´åº¦ï¼');
              if (this.isEvaluating)
                return this.warn('æ­£åœ¨æ‰§è¡Œè¯„ä¼°ï¼Œè¯·ç¨å€™...');
              if (this.isOptimizing)
                return this.warn('æ­£åœ¨æ‰§è¡Œä¼˜åŒ–ï¼Œè¯·ç­‰å¾…æ‰§è¡Œå®Œæˆ...');
            }
            if (key === 'optimize') {
              if (this.isOptimizing)
                return this.warn('æ­£åœ¨æ‰§è¡Œä¼˜åŒ–ï¼Œè¯·ç¨å€™...');
              if (this.isEvaluating)
                return this.warn('è¯„ä¼°æ­£åœ¨æ‰§è¡Œä¸­ï¼Œè¯·å…ˆå®Œæˆè¯„ä¼°ï¼');
              if (!this.evaluationResult) return this.warn('è¯·å…ˆæ‰§è¡Œè¯„ä¼°ï¼');
              if (!this.prompt.length) return this.warn('è¯·è¾“å…¥æç¤ºè¯ï¼');
              if (this.prompt.length < 5) return this.warn('æç¤ºè¯å†…å®¹è¿‡çŸ­ï¼');
              if (this.prompt.length > 5000)
                return this.warn('æç¤ºè¯å†…å®¹è¿‡é•¿ï¼');
            }
            return true;
          },
          goToAskAi() {
            // window.open('https://chat.deepseek.com/');
            window.open('https://lmarena.ai/');
            // window.open('https://ai.dangbei.com/chat');
          }
        },
        mounted() {
          // åˆå§‹åŒ–æ—¶é»˜è®¤é€‰æ‹©ä¸€äº›ç»´åº¦
          this.selectedDimensions = this.allDimensions
            .slice(0, 8)
            .map(i => i.value);
          // åŠ è½½è¡¨å•ç¼“å­˜
          this.loadCache();
          // mountedæ—¶è‡ªåŠ¨æ˜¾ç¤ºå¸®åŠ©ï¼ˆæ ¹æ®ä»Šæ—¥ä¸å†å¼¹å‡ºè®¾ç½®åˆ¤æ–­ï¼‰
          this.showHelp(true);
          // resizeäº‹ä»¶ç›‘å¬
          window.addEventListener('resize', () => {
            this.userAgent = window.navigator.userAgent;
          });
        }
      }).mount('#app');
    </script>
  </body>
</html>